
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
%物理的な干渉手段
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------

\chapter{物理的干渉手段}
%Fault攻撃は一般的に, 暗号装置が秘密鍵を用いた演算中に起こるエラーを利用する. エラーは攻撃者がハードウェア上の誤動作, またはソフトウェア上のバグを狙った物理的な干渉をすることにより導入される. 攻撃者はエラーによって得られる不正な出力値をもとに秘密鍵の情報を盗みだす. 

暗号装置に対して攻撃者が選択し得る物理的な干渉技術は, その設備を用いるための費用によって大きく2つに分けられる. 1つめは, 実施するために莫大な費用を必要とする手段である. 一般的なものとして, 計算回路に対する可干渉性の高い光ビーム(例:レーザー)照射がある\cite{377}. 2つめは, 攻撃者にとって費用面で実施が容易な手段である. なかでも, もっとも一般的なのが計算装置に対する入力(例:クロック信号, 供給電源 \cite{23}, \cite{24}, \cite{359}, \cite{369})を意図的に変化させる方法である. 

\section{高コストなFault導入技術}
攻撃者が莫大な費用のかかるFault導入技術を用いた攻撃を行うことは, 可能性として無視することのできない脅威である. ここでは, 莫大な費用とは現時点の金額でおおまかに50万円から1億円程度とする. 
このような技術は, セキュリティチップを搭載する回路に対して極めて高い精度で直接的に干渉をし, 異常な動作を引き起こす. 
また, 攻撃者は実装上難読化された回路構造に関しても, 精密に調べることでその設計を知り得, さらに部品を入れ替えることなどが可能である. 

いくつかの主要な, 高コストなFault導入技術を以下の表 \ref{tab:highcost} に記す. 

\begin{table}[htbp]
 \begin{center}
  \caption{高コストなFault導入技術}
   \begin{tabular}{ l|cccc } 
    \hline
    導入技術 & 空間的精度 & 時間的精度 & 要求される技術的知識 & 永続性\\ \hline \hline
    光パルス照射 & 中 & 中 & 中 & 低\\
    レーザービーム照射 & 高 & 高 & 高 & 低\\
    集束イオンビーム照射 & 完全 & 完全 & 極めて高い & 高 \\ \hline 
    \end{tabular}
    \label{tab:highcost}
 \end{center}
\end{table}


\newpage

%-------------------------------------------------------------------------------
\section{低コストなFault導入技術}
低コストな手法とは, 攻撃者が攻撃に必要な設備を設置するために必要な費用が少なく, 入手が困難でない方法である. それらは現時点の金額でおおまかに50万以下で入手することが可能である. 
低コストな手法は, 高コストな手法のように空間的, 時間的正確性の両方を有すFaultの導入はできない. しかしながら, 限定的な条件において極めて高い精度のFaultを導入することが可能である. 


いくつかの主要な, 低コストなFault導入技術を以下の表 \ref{tab:lowcost} に記す. 
\begin{table}[htbp]
 \begin{center}
  \caption{低コストなFault導入技術}
   \begin{tabular}{ l|cccc } 
    \hline
    導入技術 & 空間的精度 & 時間的精度 & 要求される技術的知識 & 永続性\\ \hline \hline
    低電圧 & 高 & 無 & 低 & 無\\
    電圧の急上昇 & 低 & 中 & 低 & 無\\
    クロック周波数の変化 & 低 & 高 & 中 & 無 \\ 
    温度変化 & 低 & 無 & 中 & 低\\
    電磁パルス & 低 & 中 & 低 & 低\\
    光照射 & 低 & 低 & 低 & 高\\
    \hline 
    \end{tabular}
    \label{tab:lowcost}
 \end{center}
\end{table}


\section{楕円曲線暗号装置に対するFaultの導入}
楕円曲線暗号の実装は組み込み機器として, またはソフトウェアによって汎用プロセッサー上に実装される. 図\ref{fig:implement}は一般的な実装の概略図である. 
一般的な実装では, 一時的な記憶領域としてRAMまたはregister fileを使用し, ALU(Arithmetic Logic Unit)で論理演算または四則演算を行う. 秘密情報であるスカラー値$ k $は外部干渉から保護されたチップで保存および生成される. それ以外の楕円曲線暗号に用いる各パラメータ(楕円曲線のパラメータ$a, b$や曲線の定義体, 入力点$P$)は通常, 不揮発性メモリであるROMに記憶される. 

すなわち, 楕円曲線暗号に用いる各パラメータは物理的に保護されていないため, 記憶領域であるROMに直接干渉してビットを変化させることや供給電源を変化させデータの読み込み, 書き込みにおいてデータを変化させることが可能となる. また実装環境によって異なるが, Fault導入の対象を入力点でなく, 曲線のパラメータや定義体の標数とすることは同程度の困難さで実行することができる. 


\begin{figure}
\begin{center}
\includegraphics[width=100mm]{system.eps}
\label{fig:implement}
\caption{: 楕円曲線暗号の実装}
\end{center}
\end{figure}